<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="pnBoardMapper">
	<resultMap type="PnBoard" id="pnBoardResultSet">
		<result column="post_no" property="postNo"/>
		<result column="mem_no" property="memNo"/>
		<result column="partner_name" property="partnerName"/>
		<result column="partner_type" property="partnerType"/>
		<result column="partner_original_img" property="partnerOriginalImg"/>
		<result column="partner_change_img" property="partnerChangeImg"/>
		<result column="partner_date" property="partnerDate"/>
		<result column="partner_views" property="partnerViews"/>
		<result column="partner_title" property="partnerTitle"/>
		<result column="partner_content" property="partnerContent"/>
		<result column="partner_start_date" property="partnerStartDate"/>
		<result column="partner_end_date" property="partnerEndDate"/>
		<result column="partner_location" property="partnerLocation"/>
		<result column="partner_number" property="partnerNumber"/>
		<result column="partner_status" property="partnerStatus"/>
		<collection property="member" resultMap="memberResultSet"/>
	</resultMap>


	<resultMap type="Member" id="memberResultSet">
		<result column="MEM_NO" property="memNo"/>
		<result column="MEM_ID" property="memId"/>
		<result column="MEM_PWD" property="memPwd"/>
		<result column="MEM_NAME" property="memName"/>
		<result column="MEM_NICKNAME" property="memNickname"/>
		<result column="GENDER" property="gender"/>
		<result column="ENROLL_DATE" property="enrollDate"/>
		<result column="MEM_STATUS" property="status"/>
		<result column="MEM_MBTI" property="mbti"/>
		<result column="MEM_EMAIL" property="email"/>
		<result column="MEM_IMG" property="img"/>
	</resultMap>
	

	<resultMap type="PnReply" id="pnReplyResultSet">
		<result column="reply_no" property="replyNo"/>
		<result column="board_no" property="boardNo"/>
		<result column="mem_no" property="memNo"/>
		<result column="reply_contents" property="replyContents"/>
		<result column="reply_date" property="replyDate"/>
		<result column="reply_distinct" property="replyDistinct"/>
	</resultMap>
	
	<select id="selectListCount" resultType="_int">
		select
				count(*)
		from tb_partner
		where partner_status = 'Y'
	</select>
	
	
	<select id="selectList" resultMap="pnBoardResultSet">
		select
			p.post_no
			,	p.partner_type
			,	p.partner_original_img
			,	p.partner_title
			,	p.partner_content
			,	p.partner_start_date
			,	p.partner_end_date
			,	p.partner_location
            ,   m.gender
            ,   m.mem_nickname
            ,	m.mem_mbti
            ,	m.mem_img
		from tb_partner p
        inner join tb_member m
        on  p.mem_no = m.mem_no
		where partner_status = 'Y'
		order by post_no desc
	</select>
	
	
	<update id="increaseCount">
		update
			tb_partner
		set partner_views = partner_views + 1
		where post_no = #{post_no}
			and partner_status = 'Y'
	</update>
	
	
	<select id="selectPnBoard" resultMap="pnBoardResultSet">
		select
				p.post_no
			,	p.partner_type
			,	p.partner_original_img
			,	p.partner_date
			,	p.partner_views
			,	p.partner_title
			,	p.partner_content
			,	p.partner_start_date
			,	p.partner_end_date
			,	p.partner_location
			,	p.partner_number
            ,   m.gender
            ,   m.mem_nickname
            ,	m.mem_mbti
            ,	m.mem_img
        from tb_partner p
        inner join tb_member m
        on  p.mem_no = m.mem_no
		where post_no = #{post_no}
	</select>
	
	
</mapper>













